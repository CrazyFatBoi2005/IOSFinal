# Подробное описание реализации финансового приложения (iOS)

Данный документ описывает структуру проекта, назначение каждого файла и основные функции. Архитектура проекта — **MVC (Model-View-Controller)** на базе **UIKit**.

## Архитектура
Проект разделен на логические слои:
1.  **Models**: Сущности базы данных (Core Data).
2.  **Views**: Пользовательские интерфейсные элементы (ячейки списков).
3.  **Controllers**: Логика экранов и управление навигацией.
4.  **Services/Managers**: Работа с данными (Persistence) и уведомлениями.

---

## 1. Слой данных (Model / Persistence)

### `CoreDataStack.swift`
**Зачем**: Инициализация и настройка базы данных SQLite с помощью Core Data.
- `persistentContainer`: Создает хранилище `FinanceModel`.
- `saveContext()`: Сохраняет все изменения в базу (используется при выходе из приложения или добавлении записей).

### `PersistenceManager.swift`
**Зачем**: Основной менеджер для работы с данными (CRUD — Create, Read, Update, Delete).
- `createCategory(...)`: Создает новую финансовую категорию.
- `createTransaction(...)`: Записывает новую трату или доход.
- `fetchCategoriesSorted(by:)`: **(Требование соблюдено)** Функция сортировки категорий по количеству транзакций или по сумме за месяц.

### `Models/`
- `Category+CoreDataClass.swift`: Описание категории (название, иконка, цвет, тип).
- `Transaction+CoreDataClass.swift`: Описание транзакции (сумма, дата, связь с категорией).
- `Goal+CoreDataClass.swift`: **(Требование соблюдено)** Описание цели на месяц (лимит суммы для конкретной категории).

---

## 2. Логика и Уведомления

### `NotificationManager.swift`
**Зачем**: Организация взаимодействия с пользователем через пуш-уведомления.
- `requestAuthorization()`: Запрашивает разрешение на отправку уведомлений.
- `scheduleDailyReminder()`: **(Требование соблюдено)** Напоминает пользователю зайти и записать расходы (каждый день в 20:00).
- `sendGoalSuccessNotification(...)`: **(Требование соблюдено)** Оповещает пользователя, если цель по категории успешно соблюдена.

---

## 3. Экраны (Controllers & Views)

### `MainTabBarController.swift`
Главный контейнер с тремя вкладками: **Траты**, **Аналитика** и **Цели**.

### `DashboardViewController.swift`
**Зачем**: Главный экран со списком операций.
- `setupHeader()`: Отображает текущий Баланс, общие Доходы и Расходы.
- `didTapAdd()`: Открывает экран добавления новой транзакции.

### `AddTransactionViewController.swift`
**Зачем**: Форма ввода данных.
- Содержит поля для суммы, даты и выбора категории.

### `AnalyticsViewController.swift`
**Зачем**: Анализ трат.
- `segmentedControl`: **(Требование соблюдено)** Позволяет переключать вид (Неделя / Месяц / Год) для глобальной аналитики.
- Подготовлен к выводу графиков через библиотеку **DGCharts**.

### `GoalsViewController.swift`
**Зачем**: Мониторинг лимитов.
- `GoalCell`: Отображает прогресс-бары, которые меняют цвет в зависимости от процента трат в лимитированной категории.

---

## Проверка требований
1.  **Запись трат и прибыли**: Реализовано (`AddTransactionViewController`).
2.  **Аналитика**: Реализовано (`AnalyticsViewController`).
3.  **Несколько категорий**: Реализовано (Модель `Category`).
4.  **Цели на месяц**: Реализовано (Модель `Goal` + `GoalsViewController`).
5.  **Уведомления**: Реализовано (`NotificationManager`).
6.  **Сортировка категорий**: Реализовано в `PersistenceManager`.
7.  **Глобальная аналитика**: Реализовано переключение периодов.
8.  **Архитектура MVC**: Полностью переведено на UIKit MVC.
